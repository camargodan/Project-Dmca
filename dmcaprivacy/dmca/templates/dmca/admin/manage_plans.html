{% extends 'dmca/tables_content.html' %}
{% load static %}

{% block title %} Manage Plans {% endblock %}

{% block title_content %} Manage Plans {% endblock %}

{% block tables_complet %}

        <h4 class="card-title">Manage Plans</h4>
      <p class="card-description">
          <button id="create-plan" type="button" name="button" class="btn btn-primary">
        <i class="ti-plus"></i>
        Add New
        </button>
      {% if messages %}
          <div class="alert alert-warning" role="alert">
            <strong>Messages:</strong>
            <ul>
              {% for message in messages %}
              <li {% if message.tags %} class="{{ message.tags }}"{% endif %}>
                {{message}}
              </li>
              {% endfor %}
            </ul>
          </div>
      {% endif %}
      </p>

      <div class="table-responsive">
        <table id="list_plans" class="table table-striped" >
            {#  table content suppressed #}
        <thead>
            <tr>
              <th>
                Id
              </th>
              <th>
                Plans
              </th>
              <th>
                Options
              </th>
            </tr>
        </thead>
          <tbody>
                {#  DATATABLE#}
          </tbody>
        </table>
      </div>



{% endblock %}

{% block extra_body %}
    {% include 'dmca/js_tables.html' %}
    {% include 'dmca/js_modal_ajax.html' %}

    <script type="application/javascript">
        {#START CALL DATATABLE#}
        $(function () {
            $('#list_plans').DataTable({
                responsive: true,
                autoWidth: false
            });

            $('#create-plan').on('click', function () {
                $.ajax({
                    url: '{% url 'manage_plans' %}',
                    type: 'POST',
                    data: {id: 1},
                    dataType: 'json'
                }).done(function (data) {
                    console.log(data);
                }).fail(function (jqXHR, textStatus, errorThrown) {
                    alert(textStatus + ': ' + errorThrown);
                }).always(function (data) {

                });
            });
        });
        {#END CALL DATATABLE#}
    {#START OF AJAX FUNCTIONS#}
    $(function () {
        $('#list_plans').DataTable({
            responsive: true,
            autoWidth: false,
            destroy: true,
            deferRender: true,
            ajax: {
                url: window.location.pathname,
                type: 'POST',
                data: {
                    'action': 'searchdata'
                },
                dataSrc: ""
            },
            columns: [
                {"data": "id_plan"},
                {"data": "plan"},
                {"data": "plan"},
            ],
            columnDefs: [
                {
                    targets: [-1],
                    class: 'text-center',
                    orderable: false,
                    render: function (data, type, row) {
                        var buttons = '<a href="/erp/category/update/' + row.id + '/" type="button" class="btn btn-outline-warning py-1"><i class="ti-cut"></i></a> ';
                        buttons += '<a href="/erp/category/delete/' + row.id + '/" type="button" class="btn btn-outline-danger py-1"><i class="ti-trash"></i></a>';
                        return buttons;
                    }
                },
            ],
            initComplete: function (settings, json) {
            }
        });
    });

    </script>

{% endblock %}






