{% extends 'dmca/base_layout.html' %}
{% load static %}
{% block title %} Home {% endblock %}
{% block title_content %} Home {% endblock %}

{% block content %}
    <div class="content-wrapper">
    {# Title and back button#}
        <div class="row">
            <div class="col-md-12 grid-margin">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h4 class="font-weight-bold mb-0">DMCAprivacy dashboard</h4>
                    </div>
                    <div>
                        <a role="button" href="{% url 'reports_list' %}" type="button" class="btn btn-primary btn-icon-text btn-rounded">
                            <i class="ti-files btn-icon-prepend"></i>Report
                        </a>
                    </div>
                </div>
            </div>
        </div>

        {# Totals div's#}
        <div class="row">
            <div class="col-md-3 grid-margin stretch-card">
                <div class="card">
                    <div class="card-body">
                        <p class="card-title text-md-center text-xl-left">Total URL's</p>
                        <div class="d-flex flex-wrap justify-content-between justify-content-md-center justify-content-xl-between align-items-center">
                            <h3 class="mb-0 mb-md-2 mb-xl-0 order-md-1 order-xl-0">
                                {{ total }}
                            </h3>
                            <i class="fas fa-globe icon-md text-muted mb-0 mb-md-3 mb-xl-0"></i>
                        </div>
                        <p class="mb-0 mt-2 text-success"><span class="text-black ml-1"><small>since ({{ user.date_joined }})</small></span></p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 grid-margin stretch-card">
                <div class="card">
                    <div class="card-body">
                        <p class="card-title text-md-center text-xl-left">Google Images</p>
                        <div class="d-flex flex-wrap justify-content-between justify-content-md-center justify-content-xl-between align-items-center">
                            <h3 class="mb-0 mb-md-2 mb-xl-0 order-md-1 order-xl-0">
                                {{ images.cant_urls_gore__sum }}
                            </h3>
                            <i class="far fa-id-badge icon-md text-muted mb-0 mb-md-3 mb-xl-0"></i>
                        </div>
                        <p class="mb-0 mt-2 text-success">100% <span class="text-black ml-1"><small>Approved </small></span></p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 grid-margin stretch-card">
                <div class="card">
                    <div class="card-body">
                        <p class="card-title text-md-center text-xl-left">Google Content</p>
                        <div class="d-flex flex-wrap justify-content-between justify-content-md-center justify-content-xl-between align-items-center">
                            <h3 class="mb-0 mb-md-2 mb-xl-0 order-md-1 order-xl-0">
                                {{ content.cant_urls_gore__sum }}
                            </h3>
                            <i class="fas fa-photo-video icon-md text-muted mb-0 mb-md-3 mb-xl-0"></i>
                        </div>
                        <p class="mb-0 mt-2 text-success">100%<span class="text-black ml-1"><small> Approved</small></span></p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 grid-margin stretch-card">
                <div class="card">
                    <div class="card-body">
                        <p class="card-title text-md-center text-xl-left">DMCA Tubes</p>
                        <div class="d-flex flex-wrap justify-content-between justify-content-md-center justify-content-xl-between align-items-center">
                            <h3 class="mb-0 mb-md-2 mb-xl-0 order-md-1 order-xl-0">
                                {{ tubes.cant_urls__sum }}
                            </h3>
                            <i class="fas fa-eraser icon-md text-muted mb-0 mb-md-3 mb-xl-0"></i>
                        </div>
                        <p class="mb-0 mt-2 text-success">100%<span class="text-black ml-1"><small> Approved</small></span></p>
                    </div>
                </div>
            </div>
        </div>


        <div class="row">
            {# 1ts charts#}
            <div class="col-lg-6 grid-margin stretch-card">
                <div class="card">
                    <div class="card-body">
                        <div class="last_week_div">
                            <h4 class="card-title">Last week reports</h4>
                            <canvas id="barChart" width="461" height="330" style="display: block; width: 461px; height: 230px;" class="chartjs-render-monitor"></canvas>
                        </div>
                        <div class="this_month_div">
                            <h4 class="card-title">This month reports</h4>
                            <canvas id="barChart2" width="461" height="330" style="display: block; width: 461px; height: 230px;" class="chartjs-render-monitor"></canvas>
                        </div>
                        <div class="last_month_div">
                            <h4 class="card-title">Last month reports</h4>
                            <canvas id="barChart3" width="461" height="330" style="display: block; width: 461px; height: 230px;" class="chartjs-render-monitor"></canvas>
                        </div>
                        <div class="two_month_div">
                            <h4 class="card-title">2 month ago</h4>
                            <canvas id="barChart4" width="461" height="330" style="display: block; width: 461px; height: 230px;" class="chartjs-render-monitor"></canvas>
                        </div>
                    </div>

                    <div class="card border-right-0 border-left-0 border-bottom-0">
                        <div class="d-flex justify-content-center justify-content-md-end">
                            <div class="dropdown flex-md-grow-1 flex-xl-grow-0">
                                <button class="btn btn-lg alert-info dropdown-toggle rounded-0 border-top-0 border-bottom-0" type="button" id="dropdownMenuDate2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                  <i class="far fa-chart-bar"></i>  <b>Reports Charts</b>
                                </button>
                                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuDate2">
                                    <a class="dropdown-item" id="last_week_btn" href="#">Last week</a>
                                    <a class="dropdown-item" id="this_month_btn" role="button">This month</a>
                                    <a class="dropdown-item" id="last_month_btn" href="#">Last month</a>
                                    <a class="dropdown-item" id="two_month_btn" href="#">2 month ago</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {# 2ts charts#}
            <div class="col-lg-6 grid-margin stretch-card">
                <div class="card">
                    <div class="card-body">
                        <div class="last_week_div">
                            <h4 class="card-title">Reports Type</h4>
                            <canvas id="pieChart" width="461" height="330" style="display: block; width: 461px; height: 230px;" class="chartjs-render-monitor"></canvas>
                        </div>
                        <div class="this_month_div">
                            <h4 class="card-title">Reports Type</h4>
                            <canvas id="pieChart2" width="461" height="330" style="display: block; width: 461px; height: 230px;" class="chartjs-render-monitor"></canvas>
                        </div>
                        <div class="last_month_div">
                            <h4 class="card-title">Reports Type</h4>
                            <canvas id="pieChart3" width="461" height="330" style="display: block; width: 461px; height: 230px;" class="chartjs-render-monitor"></canvas>
                        </div>
                        <div class="two_month_div">
                            <h4 class="card-title">Reports Type</h4>
                            <canvas id="pieChart4" width="461" height="330" style="display: block; width: 461px; height: 230px;" class="chartjs-render-monitor"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock content %}

{% block extra_body %}
    {# styles for the charts#}
    <style>
        .this_month_div{display: none;}
        .last_month_div{display: none;}
        .two_month_div{display: none;}
    </style>
    {# All the scripts for the charts#}
<script>
$(document).ready(function(){
    const randomNum = () => Math.floor(Math.random() * (235 - 52 + 1) + 52);
    const randomRGB = () => `rgba(${randomNum()}, ${randomNum()}, ${randomNum()}, 0.6)`;
    const randomRGBBorder = () => `rgba(200, 200, 200, 1)`;

    $("#last_week_btn").click(function(){
        $('.this_month_div').hide(1000);
        $('.last_month_div').hide(1000);
        $('.two_month_div').hide(1000);
        $('.last_week_div').slideToggle("slow");
    });

    $("#this_month_btn").click(function(){
        $('.last_week_div').hide(1000);
        $('.last_month_div').hide(1000);
        $('.two_month_div').hide(1000);
        $('.this_month_div').slideToggle("slow");
    });
    $("#last_month_btn").click(function(){
        $('.last_week_div').hide(1000);
        $('.this_month_div').hide(1000);
        $('.two_month_div').hide(1000);
        $('.last_month_div').slideToggle("slow");
    });
    $("#two_month_btn").click(function(){
        $('.last_week_div').hide(1000);
        $('.this_month_div').hide(1000);
        $('.last_month_div').hide(1000);
        $('.two_month_div').slideToggle("slow");
    });

    /* ChartJS
      * -------
      * Data and config for chartjs
      */
    'use strict';
    var data = {
        labels: [{%for data in last_week%}'{{data.date_gore}}',{%endfor%}],
        datasets: [{
            label: "# of Url's approved",
            data: [{%for data in last_week%}'{{data.cant_urls_gore}}',{%endfor%}],
            backgroundColor: [{%for data in last_week%} randomRGB(),{%endfor%}],
            borderColor: [randomRGBBorder()],
            borderWidth: 1,
            fill: false
        }]
    };
    var dataPie = {
        datasets: [{
            data: ['{{ last_week_images.cant_urls_gore__sum }}', '{{ last_week_content.cant_urls_gore__sum }}'],
            backgroundColor: [randomRGB(), randomRGB()],
            borderColor: [randomRGBBorder()],
        }],
        // These labels appear in the legend and in the tooltips when hovering different arcs
        labels: [
            'DMCA-IMAGES',
            'DMCA-CONTENT',
        ]
    };


    var data2 = {
        labels: [{%for data in this_month%}'{{data.date_gore}}',{%endfor%}], //loop through queryset,
        datasets: [{
            label: "# of Url's approved",
            data: [{%for data in this_month%}'{{data.cant_urls_gore}}',{%endfor%}],
            backgroundColor: [{%for data in this_month%} randomRGB(),{%endfor%}],
            borderColor: [randomRGBBorder()],
            borderWidth: 1,
            fill: false
        }]
    };
    var dataPie2 = {
        datasets: [{
            data: ['{{ this_month_images.cant_urls_gore__sum }}', '{{ this_month_content.cant_urls_gore__sum }}'],
            backgroundColor: [randomRGB(), randomRGB()],
            borderColor: [randomRGBBorder()],
        }],
        // These labels appear in the legend and in the tooltips when hovering different arcs
        labels: [
            'DMCA-IMAGES',
            'DMCA-CONTENT',
        ]
    };

    var data3 = {
        labels: [{%for data in last_month%}'{{data.date_gore}}',{%endfor%}],
        datasets: [{
            label: "# of Url's approved",
            data: [{%for data in last_month%}'{{data.cant_urls_gore}}',{%endfor%}],
            backgroundColor: [{%for data in last_month%} randomRGB(),{%endfor%}],
            borderColor: [randomRGBBorder()],
            borderWidth: 1,
            fill: false
        }]
    };
    var dataPie3 = {
        datasets: [{
            data: ['{{ last_month_images.cant_urls_gore__sum }}', '{{ last_month_content.cant_urls_gore__sum }}'],
            backgroundColor: [randomRGB(), randomRGB()],
            borderColor: [randomRGBBorder()],
        }],
        // These labels appear in the legend and in the tooltips when hovering different arcs
        labels: [
            'DMCA-IMAGES',
            'DMCA-CONTENT',
        ]
    };

    var data4 = {
        labels: [{%for data in two_month%}'{{data.date_gore}}',{%endfor%}],
        datasets: [{
            label: "# of Url's approved",
            data: [{%for data in two_month%}'{{data.cant_urls_gore}}',{%endfor%}],
            backgroundColor: [{%for data in two_month%} randomRGB(),{%endfor%}],
            borderColor: [randomRGBBorder()],
            borderWidth: 1,
            fill: false
        }]
    };
    var dataPie4 = {
        datasets: [{
            data: ['{{ two_month_images.cant_urls_gore__sum }}', '{{ two_month_content.cant_urls_gore__sum }}'],
            backgroundColor: [randomRGB(), randomRGB()],
            borderColor: [randomRGBBorder()],
        }],
        // These labels appear in the legend and in the tooltips when hovering different arcs
        labels: [
            'DMCA-IMAGES',
            'DMCA-CONTENT',
        ]
    };

    var options = {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero: true
                }
            }]
        },
        legend: {
            display: false
        },
        elements: {
            point: {
                radius: 0
            }
        }
    };

    var PieOptions = {
        responsive: true,
        animation: {
            animateScale: true,
            animateRotate: true
        }
    };

    // Get context with jQuery - using jQuery's .get() method.
    if ($("#barChart").length) {
        var barChartCanvas = $("#barChart").get(0).getContext("2d");
        // This will get the first returned node in the jQuery collection.
        var barChart = new Chart(barChartCanvas, {
            type: 'bar',
            data: data,
            options: options
        });
    }
    if ($("#barChart2").length) {
        var barChartCanvas2 = $("#barChart2").get(0).getContext("2d");
        // This will get the first returned node in the jQuery collection.
        var barChart = new Chart(barChartCanvas2, {
            type: 'bar',
            data: data2,
            options: options
        });
    }
    if ($("#barChart3").length) {
        var barChartCanvas3 = $("#barChart3").get(0).getContext("2d");
        // This will get the first returned node in the jQuery collection.
        var barChart = new Chart(barChartCanvas3, {
            type: 'bar',
            data: data3,
            options: options
        });
    }
    if ($("#barChart4").length) {
        var barChartCanvas4 = $("#barChart4").get(0).getContext("2d");
        // This will get the first returned node in the jQuery collection.
        var barChart = new Chart(barChartCanvas4, {
            type: 'bar',
            data: data4,
            options: options
        });
    }

    if ($("#pieChart").length) {
        var pieChartCanvas = $("#pieChart").get(0).getContext("2d");
        var pieChart = new Chart(pieChartCanvas, {
            type: 'pie',
            data: dataPie,
            options: PieOptions
        });
    }
    if ($("#pieChart2").length) {
        var pieChartCanvas2 = $("#pieChart2").get(0).getContext("2d");
        var pieChart2 = new Chart(pieChartCanvas2, {
            type: 'pie',
            data: dataPie2,
            options: PieOptions
        });
    }
    if ($("#pieChart3").length) {
        var pieChartCanvas3 = $("#pieChart3").get(0).getContext("2d");
        var pieChart3 = new Chart(pieChartCanvas3, {
            type: 'pie',
            data: dataPie3,
            options: PieOptions
        });
    }
    if ($("#pieChart4").length) {
        var pieChartCanvas4 = $("#pieChart4").get(0).getContext("2d");
        var pieChart4 = new Chart(pieChartCanvas4, {
            type: 'pie',
            data: dataPie4,
            options: PieOptions
        });
    }

});
</script>
{% endblock %}





